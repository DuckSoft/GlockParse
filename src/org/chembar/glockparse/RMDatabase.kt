package org.chembar.glockparse

/** RMDatabase -- 带误差的相对原子质量数据库
 * @author DuckSoft
 * @version 0.2
 */
class RMDatabase {
    /** 原子量HashMap。用于快速查询。 */
    private val RMData = HashMap<String, AdvNum>().apply {
        dataRMName.indices.forEach { i -> this[dataRMName[i]] = AdvNum(dataRMValue[i], dataRMError[i]) }
    }

    /** 异常类：原子名未发现 */
    class AtomNameNotFoundException(atomName: String) : Exception("Atom name not found: $atomName")

    /** 查询[atomName]的相对原子质量。
     * @param atomName 欲查询原子的名称的字符串。
     * @return [AdvNum]表示的原子的相对原子质量。
     * @throws AtomNameNotFoundException
     */
    @Throws(AtomNameNotFoundException::class)
    fun queryAtom(atomName: String): AdvNum {
        return RMData[atomName] ?: throw AtomNameNotFoundException(atomName)
    }

    /** 原子量数据 */
    companion object {
        private val dataRMName = arrayOf("H", "He", "Li", "Be", "B", "C", "N", "O", "F", "Ne", "Na", "Mg", "Al", "Si", "P", "S", "Cl", "Ar", "K", "Ca", "Sc", "Ti", "V", "Cr", "Mn", "Fe", "Co", "Ni", "Cu", "Zn", "Ga", "Ge", "As", "Se", "Br", "Kr", "Rb", "Sr", "Y", "Zr", "Nb", "Mo", "Tc", "Ru", "Rh", "Pd", "Ag", "Cd", "In", "Sn", "Sb", "Te", "I", "Xe", "Cs", "Ba", "La", "Ce", "Pr", "Nd", "Pm", "Sm", "Eu", "Gd", "Tb", "Dy", "Ho", "Er", "Tm", "Yb", "Lu", "Hf", "Ta", "W", "Re", "Os", "Ir", "Pt", "Au", "Hg", "Tl", "Pb", "Bi", "Th", "Pa", "U")
        private val dataRMError = doubleArrayOf(0.00007, 0.000002, 0.002, 0.0000003, 0.007, 0.0008, 0.0002, 0.0003, 0.000000006, 0.0006, 0.00000002, 0.0006, 0.0000007, 0.0003, 0.000000005, 0.005, 0.002, 0.001, 0.0001, 0.004, 0.000005, 0.001, 0.0001, 0.0006, 0.000003, 0.002, 0.000004, 0.0004, 0.003, 0.02, 0.001, 0.01, 0.000006, 0.008, 0.001, 0.002, 0.0003, 0.01, 0.00002, 0.002, 0.00002, 0.01, 0.0004, 0.02, 0.00002, 0.01, 0.0002, 0.004, 0.003, 0.007, 0.001, 0.03, 0.00003, 0.006, 0.00000006, 0.007, 0.00007, 0.001, 0.00002, 0.003, 0.2, 0.02, 0.001, 0.03, 0.00002, 0.001, 0.00002, 0.003, 0.00002, 0.005, 0.0001, 0.02, 0.00002, 0.01, 0.001, 0.03, 0.003, 0.009, 0.000005, 0.02, 0.0002, 0.1, 0.00001, 0.0004, 0.00002, 0.00003)
        private val dataRMValue = doubleArrayOf(1.00794, 4.002602, 6.941, 9.0121831, 10.811, 12.0107, 14.0067, 15.9994, 18.998403163, 20.1797, 22.98976928, 24.3050, 26.9815385, 28.0855, 30.973761998, 32.065, 35.453, 39.948, 39.0983, 40.078, 44.955908, 47.867, 50.9415, 51.9961, 54.938044, 55.845, 58.933194, 58.6934, 63.546, 65.38, 69.723, 72.64, 74.921595, 78.971, 79.904, 83.798, 85.4678, 87.62, 88.90584, 91.224, 92.90637, 95.95, 98.9072, 101.07, 102.90550, 106.42, 107.8682, 112.414, 114.818, 118.710, 121.760, 127.60, 126.90447, 131.293, 132.90545196, 137.327, 138.90547, 140.116, 140.90766, 144.242, 144.9, 150.36, 151.964, 157.25, 158.92535, 162.500, 164.93033, 167.259, 168.93422, 173.054, 174.9668, 178.49, 180.94788, 183.84, 186.207, 190.23, 192.217, 195.084, 196.966569, 200.59, 204.3833, 207.2, 208.98040, 232.0377, 231.03588, 238.02891)
    }
}